<%- include("partials/header"); -%> 
<input class="searchArea" onkeyup="sendData(this)" type="text" name="" id="search-box" placeholder="Search Title" />
<section id="searchResults">

</section>
<script>
    function sendData(e){
        const searchResults = document.getElementById('searchResults');
        let match = e.value.match(/^[ a-zA-Z ]*/);
        let match2 = e.value.match(/\s*/);
        if(match2[0] === e.value){
            searchResults.innerHTML= '';
            return;
        }
        if(match[0] === e.value){
            fetch('getPosts', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({payload: e.value})
            }).then(res => res.json()).then(data =>{
                let payload = data.payload;
                console.log(payload);
                searchResults.innerHTML= '';
                if(payload.length <1){
                    searchResults.innerHTML= '<p>Sorry. Nothing found.</p>';
                    return;
                }
                payload.forEach((item, index) => {
                    if(index >0) searchResults.innerHTML += '<hr>';
                    searchResults.innerHTML += `<a id="searchAnchor" href="/posts/${item._id}"><p>${item.title}</p></a>`;
                });
            });
            return;
        }
        searchResults.innerHTML= '';
    }
</script>

<h1 id="blogh1">All the Blogs at one place.</h1>

<p><%= blogContent %></p>


<%  posts.forEach(function(post){ %>

    <h2><%=post.title%></h2>
    <p>
    <%=post.content.substring(0, 440) + " ..."%>
    <a class="styleAnchor" href="/posts/<%=post._id%>">Read More</a>
    </p>
    
    
<% }) %>
    
<div class="pagination">
    <ul> <!--pages or li are comes from javascript --> </ul>
</div>
<script src="script.js"></script>

<%- include("partials/footer"); -%>

